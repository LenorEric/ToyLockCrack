# ToyLockCrack

Lenor

## 破解思路

### 时间复杂度

经过分析，程序的时间复杂度应该为 O(n)

### 密文分析

密文是一个字符串，而非一个数字

n 位明文对应密文是 n +1 位

### 校验位

在 1 开头的密文中，

19 <- 1

10 <- 9

对于 n 位明文，有 n 种可能的密文

100，有 1351 1597 1613

1000，有 19075（2） 16374（1） 14708（0） 41107（3）

但是 n=1 是特例，只会生成 1 种密文，但是实际上有两种可解的密文。（ TODO

猜测校验方式：

​	猜测校验码可能插入在 0~n+1 的任何一位，使得有 n 种不同的密文。

​	由于 0~10 的数据是连续变化的，但更高的不是。猜测是和校验。

​	c = sum(s[0] + s[1]  + .....) % 10

对于 100

​	c(1351) =0，c(1597）=2，c（1613）=1。猜测 c 是校验位位置。（已经对 1000 验证过了，c是 0~3

​	拿掉校验位：

​	351（1） 113（6） 157（9） / 135（1） 163（1） 197（5）（不知道这个 c 是怎么数的）

​	n = 0/1/2

​	c(351)=9 c(113)=5 c(157)=3

​	c(135) = 9 c(163)=0 c(197)=7

​	其中，对应的校验码分别为 1 1 5，

​	似乎第二种对应关系更有联系。c 和 n 同时变大，校验码不变。猜测和校验结果与 c、n 有关且是差的关系。

​	 c - n = 9, 9, 5

​	995 实际对应 115 猜测是 c=10-c

对 1000 验证：

​	可行

总结：

​	校验码规则是 对于密文 s，随机生成一个 n 使得 n 不大于 s 的长度

​	在倒数第 n 位插入校验码，值为 10 - sum(s) + n

## 无校验码

100:

135 163 197 是三种原始密文。猜测加密方式与 n 有关

先排除 n 的影响

10000000，n=0 147068671

10000001，n=0 147068680

10000002，n=0 147068699

10000010，n=0 147068770

10000100，n=0 147078670

可见密文是有特征值的



